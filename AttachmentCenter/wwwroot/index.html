<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8" />
    <title>文件服务V BETA 1.0.2</title>
</head>
<body>
    <h1 id="h1-readme"><a name="Readme" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Readme</h1><h2 id="h2-u6587u4EF6u4E0Au4F20"><a name="文件上传" class="reference-link"></a><span class="header-link octicon octicon-link"></span>文件上传</h2><ol> <li>接口地址：</li></ol> <ul> <li>url:服务器地址/UploadFile/Upload?virtualDic&amp;waterText&amp;createThumbnail=false</li><li>virtualDic 参数是必须的，建议规划好文件夹结构例如：“virtualDic=xx项目/xxx模块”</li><li>aterText: 图片水印，字符参数，可选。</li><li>createThumbnail，是否启用，bool参数，可选的。 缩略图是生成正方形或者按比率缩放是在服务端配置文件里调整的。</li><li>返回的结构:</li></ul> <pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code><span class="pun">{</span></code></li><li class="L1"><code><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code><span class="pln"> </span><span class="str">"datas"</span><span class="pun">:</span><span class="pln"> </span></code></li><li class="L3"><code><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="com">//多文件上传，此处返回的即为多个对象。</span></code></li><li class="L4"><code><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span></code></li><li class="L5"><code><span class="pln"> </span><span class="str">"originalName"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"测试测试sdfsf+ _@#￥.png"</span><span class="pun">,</span><span class="pln"> </span></code></li><li class="L6"><code><span class="pln"> </span><span class="str">"saveName"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"%E6%B5%8B%E8%AF%95%E6%B5%8B%E8%AF%95sdfsf%2B%20_%40%23%E F%BF%A5_S_20200107141957202.png"</span><span class="pln"> </span></code></li><li class="L7"><code><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span></code></li><li class="L8"><code><span class="pln"> </span><span class="pun">],</span></code></li><li class="L9"><code><span class="pln"> </span><span class="str">"message"</span><span class="pun">:</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span></code></li><li class="L0"><code><span class="pln"> </span><span class="str">"success"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span></code></li><li class="L1"><code><span class="pln"> </span><span class="pun">}</span></code></li><li class="L2"><code><span class="pun">}</span></code></li></ol></pre><ol> <li>简单文件上传：</li></ol> <p>可以用传统的file表单，可以用第三方的upload插件，只要满足提交到后台的文件时存储在 Request.Form.Files对象中即可（传统文件上传皆如此），<br>同时提交一个url参数“virtualDic=你文件存储到服务器的目标文件夹 </p><p>3.多文件上传：</p> <p>满足条件2的情况下，同时向服务器提交多个文件即可。</p> <p>4.大文件分块上传：</p> <p>满足条件2，多文件满足条件3，另外分块大小不能大于服务器设定的上传限制，整体大小不限。</p> <pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code><span class="pun">额外</span><span class="typ">Form</span><span class="pun">参数：</span></code></li><li class="L1"><code><span class="pln">name</span><span class="pun">：</span><span class="pln"> </span><span class="pun">文件原始名称（每次分块上传的是分块名称，而且每个分块名称必须唯一，所以需要传递一个原始文件名）</span></code></li><li class="L2"><code><span class="pln">chunk</span><span class="pun">：</span><span class="pln"> </span><span class="pun">当前分块序号，</span><span class="kwd">int</span><span class="pun">类型，索引从</span><span class="lit">0</span><span class="pun">开始。</span></code></li><li class="L3"><code><span class="pln">chunks</span><span class="pun">：</span><span class="pln"> </span><span class="pun">总的分块数，</span><span class="kwd">int</span><span class="pun">类型。</span></code></li></ol></pre><p>5.水印和缩略图：</p> <p>满足条件2，3 。水印和缩略图只针对图片有效。 单文件、多文件上传均生效、分块上传无效。</p> <h2 id="h2-u6587u4EF6u83B7u53D6"><a name="文件获取" class="reference-link"></a><span class="header-link octicon octicon-link"></span>文件获取</h2><ol> <li>获取文件</li></ol> <ul> <li><p>风格1：<a href="http://xxxx/Upload/上传时指定的虚拟目录/上传时返回的saveName">http://xxxx/Upload/上传时指定的虚拟目录/上传时返回的saveName</a></p> </li><li><p>风格2：<a href="http://xxxx/UploadFile/Get?FileName=xxx.jpg">http://xxxx/UploadFile/Get?FileName=xxx.jpg</a><br> GET:服务器地址/UploadFile/Files/“上传时返回的saveName” </p></li><li><p>缩略图文件获取：方式与上述两种风格相同， 文件名在saveName基础上追加Thumbnail。</p> </li><li><p><strong>举个栗子：</strong><br>服务器地址是:<a href="http://39.106.163.216:5001">http://39.106.163.216:5001</a><br>上传原文件名是：ql-2.jpg<br>上传的目录是 project/Reports<br>服务器返回一个： “saveName”: “ql-2_S_20200108155128215Thumbnail.jpg”<br>原图地址1：<a href="http://39.106.163.216:5001/UploadFile/Get?FileName=ql-2_S_20200108155128215.jpg">http://39.106.163.216:5001/UploadFile/Get?FileName=ql-2_S_20200108155128215.jpg</a><br>缩略图地址1：<a href="http://39.106.163.216:5001/UploadFile/Get?FileName=ql-2_S_20200108155128215Thumbnail.jpg">http://39.106.163.216:5001/UploadFile/Get?FileName=ql-2_S_20200108155128215Thumbnail.jpg</a><br>原图地址2：<a href="http://39.106.163.216:5001/Upload/project/Reports/ql-2_S_20200108155128215.jpg">http://39.106.163.216:5001/Upload/project/Reports/ql-2_S_20200108155128215.jpg</a><br>缩略图地址2：<a href="http://39.106.163.216:5001/Upload/project/Reports/ql-2_S_20200108155128215Thumbnail.jpg">http://39.106.163.216:5001/Upload/project/Reports/ql-2_S_20200108155128215Thumbnail.jpg</a><br><strong>两者差别就是:</strong><br>第一个种不用带目录，浏览器能当附件下载（常用于附件)<br>第二种要带目录，支持在线播放（视频），在线预览 </p></li></ul> <h2 id="h2-u6587u4EF6u5220u9664"><a name="文件删除" class="reference-link"></a><span class="header-link octicon octicon-link"></span>文件删除</h2><ol> <li>删除文件 DELETE: </li></ol> <p>服务器地址/UploadFile/Delete/“上传时返回的saveName”</p> <h2 id="h2-u793Au4F8B"><a name="示例" class="reference-link"></a><span class="header-link octicon octicon-link"></span>示例</h2><p><a href="/Test.html">多文件上传示例</a></p> <p><a href="/UploadSingle.html">单文件上传示例</a></p> <h2 id="h2--"><a name="更新日志：" class="reference-link"></a><span class="header-link octicon octicon-link"></span>更新日志：</h2><p>2020 -1-9 ：Version Beta 1.0.2修复MP4在线播放的bug，处理rar文件下载后大小变化的BUG。<br>2020 -1-8 ：Version Beta 1.0.1增加缩略图功能、增加文件直接访问的方式、增加单个文件上传示例、增加首页说明文档。 </p><h2 id="h2-u95EEu9898u53CDu9988"><a name="问题反馈" class="reference-link"></a><span class="header-link octicon octicon-link"></span>问题反馈</h2><p>qq 270535197</p>
</body>
</html>
